<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <!-- List View Ù…Ù†ÙØµÙ„ Ù„Ù„Ù€ API Lines Ù…Ø¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© -->
    <record id="view_api_lines_list" model="ir.ui.view">
        <field name="name">api.lookup.lines.list</field>
        <field name="model">api.lookup.lines</field>
        <field name="arch" type="xml">
            <list create="false" delete="false" edit="false">
                <field name="description" string="Description"/>
                <field name="ar_name" string="Arabic Name"/>
                <field name="en_name" string="English Name"/>
                <field name="city_ar_name" string="City (AR)" invisible="context.get('lookup_action') != 'branch-all'"/>
                <field name="region_ar_name" string="Region (AR)" invisible="context.get('lookup_action') != 'branch-all'"/>
                <field name="district_ar" string="District (AR)" invisible="context.get('lookup_action') != 'branch-all'"/>
                <field name="transfer_id" string="ID"/>
                <field name="system_id" string="Code"/>
                <button name="action_view_raw_data"
                        type="object"
                        string="View Raw"
                        icon="fa-code"
                        class="btn-link"/>
            </list>
        </field>
    </record>

    <!-- Form View Ù„Ù„Ù€ API Lines -->
    <record id="view_api_lines_form" model="ir.ui.view">
        <field name="name">api.lookup.lines.form</field>
        <field name="model">api.lookup.lines</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="description" placeholder="Description..."/>
                        </h1>
                    </div>

                    <group>
                        <group string="Names">
                            <field name="ar_name"/>
                            <field name="en_name"/>
                        </group>
                        <group string="IDs">
                            <field name="transfer_id"/>
                            <field name="system_id"/>
                        </group>
                    </group>

                    <!-- Ù…Ø¬Ù…ÙˆØ¹Ø© Ø®Ø§ØµØ© Ø¨Ø§Ù„ÙØ±ÙˆØ¹ -->
                    <group string="Branch Location Details" invisible="not city_ar_name and not region_ar_name and not district_ar">
                        <group>
                            <field name="city_ar_name"/>
                            <field name="region_ar_name"/>
                        </group>
                        <group>
                            <field name="district_ar"/>
                        </group>
                    </group>

                    <notebook>
                        <page string="Raw Data" name="raw_data">
                            <field name="raw_data"
                                   widget="text"
                                   style="font-family: 'Courier New', monospace; font-size: 12px;"/>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <!-- Form View Ù„Ù€ API Response Viewer -->
    <record id="view_api_response_viewer_form" model="ir.ui.view">
        <field name="name">api.response.viewer.form</field>
        <field name="model">api.response.viewer</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="title" readonly="1"/>
                        </h1>
                    </div>

                    <group>
                        <field name="content_type" readonly="1"/>
                    </group>

                    <field name="content"
                           widget="text"
                           readonly="1"
                           style="font-family: 'Courier New', monospace; font-size: 12px; background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 10px;"/>
                </sheet>
            </form>
        </field>
    </record>

    <!-- Form View Ù„Ù„Ù€ API Wizard -->
    <record id="view_api_wizard_form" model="ir.ui.view">
        <field name="name">api.lookup.wizard.form</field>
        <field name="model">api.lookup.wizard</field>
        <field name="arch" type="xml">
            <form>
                <header>
                    <button name="action_fetch_data"
                            type="object"
                            string="ğŸ”„ Fetch Data"
                            class="oe_highlight"
                            invisible="state == 'loading'"/>
                    <button name="action_clear_data"
                            type="object"
                            string="ğŸ—‘ï¸ Clear Data"
                            class="btn-secondary"
                            invisible="state in ['draft', 'loading']"/>
                    <button name="action_view_full_response"
                            type="object"
                            string="ğŸ“„ View Full Response"
                            class="btn-info"
                            invisible="state != 'loaded'"/>
                    <!-- Ø²Ø± Ø±Ø¨Ø· Ø§Ù„Ø¨Ù„Ø¯Ø§Ù† ÙˆØ§Ù„Ø¬Ù†Ø³ÙŠØ§Øª - Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ù…ÙˆØ­Ø¯Ø© -->
                    <button name="action_link_countries"
                            type="object"
                            string="ğŸ”— Link to Odoo Countries"
                            class="btn-success"
                            invisible="lookup_action not in ['country', 'yakeen-nationality'] or state != 'loaded'"
                            confirm="Ù‡Ù„ ØªØ±ÙŠØ¯ Ø±Ø¨Ø· Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù…Ø¹ Ø§Ù„Ø¨Ù„Ø¯Ø§Ù† ÙÙŠ Ù†Ø¸Ø§Ù… Ø£ÙˆØ¯ÙˆØŸ Ø³ÙŠØªÙ… Ù…Ø·Ø§Ø¨Ù‚Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ ÙˆØ§Ù„Ø£ÙƒÙˆØ§Ø¯."/>
                    <field name="state" widget="statusbar"/>
                </header>

                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="lookup_action"
                                   placeholder="Select API Endpoint..."
                                   required="1"/>
                        </h1>
                    </div>

                    <group>
                        <group>
                            <field name="url" readonly="1" invisible="not url"/>
                            <field name="total_records" readonly="1" invisible="not total_records"/>
                        </group>
                        <group>
                            <field name="last_sync" readonly="1" invisible="not last_sync"/>
                        </group>
                    </group>

                    <!-- ØªØ­Ø°ÙŠØ± Ø®Ø§Øµ Ø¨Ø§Ù„Ø¨Ù„Ø¯Ø§Ù† ÙˆØ§Ù„Ø¬Ù†Ø³ÙŠØ§Øª - Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ù…ÙˆØ­Ø¯Ø© -->
                    <div class="alert alert-info"
                         invisible="lookup_action not in ['country', 'yakeen-nationality'] or state != 'loaded'">
                        <h4><strong>ğŸŒ Ù…ÙŠØ²Ø© Ø§Ù„Ø±Ø¨Ø· Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø§Ù„Ù…ÙˆØ­Ø¯</strong></h4>
                        <p invisible="lookup_action != 'country'">ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ø±Ø¨Ø· Ø§Ù„Ø¨Ù„Ø¯Ø§Ù† Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ Ø£ÙˆØ¯Ùˆ Ù…Ø¹ Ù…Ø¹Ø±ÙØ§ØªÙ‡Ø§ ÙÙŠ Ù…Ù†ØµØ© Ù†Ù‚Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹.</p>
                        <p invisible="lookup_action != 'yakeen-nationality'">ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ø±Ø¨Ø· Ø§Ù„Ø¬Ù†Ø³ÙŠØ§Øª Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ Ø£ÙˆØ¯Ùˆ Ù…Ø¹ Ù…Ø¹Ø±ÙØ§ØªÙ‡Ø§ ÙÙŠ Ù…Ù†ØµØ© Ù†Ù‚Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹.</p>
                        <p><strong>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¹Ù…Ù„:</strong> Ø³ÙŠØªÙ… Ù…Ø·Ø§Ø¨Ù‚Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØŒ Ø§Ù„Ø¹Ø±Ø¨ÙŠØŒ ÙˆØ§Ù„ÙƒÙˆØ¯.</p>
                        <p invisible="lookup_action != 'country'"><strong>Ø­Ù‚Ù„ Ø§Ù„Ø±Ø¨Ø·:</strong> <code>naql_id</code></p>
                        <p invisible="lookup_action != 'yakeen-nationality'"><strong>Ø­Ù‚Ù„ Ø§Ù„Ø±Ø¨Ø·:</strong> <code>nationality_naql_id</code></p>
                        <p><strong>âœ¨ Ø§Ù„Ø¬Ø¯ÙŠØ¯:</strong> Ø¯Ø§Ù„Ø© Ù…ÙˆØ­Ø¯Ø© Ù„Ù„Ù†ÙˆØ¹ÙŠÙ† Ù…Ø¹ Ù…Ø¹Ø§Ù„Ø¬Ø© Ù…Ø­Ø³Ù†Ø© Ù„Ù„Ù€ IDs!</p>
                    </div>

                    <!-- Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø­Ø§Ù„Ø© -->
                    <div class="alert alert-info text-center"
                         invisible="state != 'loading'">
                        <i class="fa fa-spinner fa-spin fa-2x"></i>
                        <h4 class="mt-3"><strong>ğŸ”„ Loading data from STA API...</strong></h4>
                        <p>Please wait while we fetch the latest data.</p>
                    </div>

                    <div class="alert alert-success"
                         invisible="state != 'loaded'">
                        <i class="fa fa-check-circle fa-2x"></i>
                        <h4><strong>âœ… Data loaded successfully!</strong></h4>
                        <p><field name="response_message" readonly="1"/></p>
                    </div>

                    <div class="alert alert-danger"
                         invisible="state != 'error'">
                        <i class="fa fa-exclamation-triangle fa-2x"></i>
                        <h4><strong>âŒ Error occurred!</strong></h4>
                        <p><field name="response_message" readonly="1"/></p>
                    </div>

                    <!-- Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª -->
                    <notebook invisible="not api_lines_ids">
                        <page string="ğŸ“Š API Response Data" name="api_data">
                            <field name="api_lines_ids" nolabel="1" context="{'lookup_action': lookup_action}">
                                <list>
                                    <field name="description" string="Description"/>
                                    <field name="ar_name" string="ğŸ‡¸ğŸ‡¦ Arabic Name"/>
                                    <field name="en_name" string="ğŸ‡ºğŸ‡¸ English Name"/>
                                    <field name="city_ar_name" string="ğŸ™ï¸ City (AR)"
                                           invisible="parent.lookup_action != 'branch-all'"/>
                                    <field name="region_ar_name" string="ğŸ—ºï¸ Region (AR)"
                                           invisible="parent.lookup_action != 'branch-all'"/>
                                    <field name="district_ar" string="ğŸ˜ï¸ District (AR)"
                                           invisible="parent.lookup_action != 'branch-all'"/>
                                    <field name="transfer_id" string="ID"/>
                                    <field name="system_id" string="Code"/>
                                    <button name="action_view_raw_data"
                                            type="object"
                                            string="View Raw"
                                            icon="fa-code"
                                            class="btn-link"/>
                                </list>
                            </field>
                        </page>

                        <page string="ğŸ“ˆ Statistics" name="stats">
                            <div class="row mt-3">
                                <div class="col-md-3">
                                    <div class="card bg-primary text-white text-center">
                                        <div class="card-body">
                                            <i class="fa fa-database fa-2x mb-2"></i>
                                            <h2><field name="total_records" readonly="1"/></h2>
                                            <p>Total Records</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card bg-success text-white text-center">
                                        <div class="card-body">
                                            <i class="fa fa-check-circle fa-2x mb-2"></i>
                                            <h2>
                                                <span invisible="state != 'loaded'">âœ“</span>
                                                <span invisible="state != 'error'">âœ—</span>
                                                <span invisible="state not in ['loaded', 'error']">-</span>
                                            </h2>
                                            <p>Status</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card bg-info text-white text-center">
                                        <div class="card-body">
                                            <i class="fa fa-flag fa-2x mb-2"></i>
                                            <h2><span class="badge badge-light">AR/EN</span></h2>
                                            <p>Multi-Language</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card bg-warning text-white text-center">
                                        <div class="card-body">
                                            <!-- Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ù…Ø®ØªÙ„ÙØ© Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹ -->
                                            <i class="fa fa-link fa-2x mb-2"
                                               invisible="lookup_action not in ['country', 'yakeen-nationality']"></i>
                                            <i class="fa fa-building fa-2x mb-2"
                                               invisible="lookup_action != 'branch-all'"></i>
                                            <i class="fa fa-eye fa-2x mb-2"
                                               invisible="lookup_action in ['country', 'yakeen-nationality', 'branch-all']"></i>

                                            <!-- Ø²Ø± Ø§Ù„Ø±Ø¨Ø· Ø§Ù„Ù…ÙˆØ­Ø¯ Ù„Ù„Ø¨Ù„Ø¯Ø§Ù† ÙˆØ§Ù„Ø¬Ù†Ø³ÙŠØ§Øª -->
                                            <button name="action_link_countries"
                                                    type="object"
                                                    string="ğŸ”— Link Data"
                                                    class="btn btn-light btn-block"
                                                    invisible="lookup_action not in ['country', 'yakeen-nationality'] or state != 'loaded'"/>

                                            <!-- Ø²Ø± Ø¹Ø±Ø¶ Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ù„Ù„Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø£Ø®Ø±Ù‰ -->
                                            <button name="action_view_full_response"
                                                    type="object"
                                                    string="ğŸ“„ View Response"
                                                    class="btn btn-light btn-block"
                                                    invisible="lookup_action in ['country', 'yakeen-nationality'] or state != 'loaded'"/>

                                            <!-- Ù†ØµÙˆØµ Ù…Ø®ØªÙ„ÙØ© Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹ -->
                                            <p invisible="state == 'loaded'">No Data</p>
                                            <p invisible="lookup_action not in ['country', 'yakeen-nationality'] or state != 'loaded'">Smart Link</p>
                                            <p invisible="lookup_action != 'branch-all' or state != 'loaded'">Branch Details</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </page>
                    </notebook>

                    <!-- Ø±Ø³Ø§Ù„Ø© ÙÙŠ Ø­Ø§Ù„Ø© Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ø¨ÙŠØ§Ù†Ø§Øª -->
                    <div class="alert alert-warning text-center"
                         invisible="api_lines_ids or state != 'draft'">
                        <i class="fa fa-info-circle fa-2x"></i>
                        <h4 class="mt-3">Welcome to API Lookup Tool</h4>
                        <p>Please select an API endpoint and click "Fetch Data" to begin.</p>
                        <p class="text-muted">This tool will extract Arabic and English names from the API response.</p>

                        <!-- Ø±Ø³Ø§Ø¦Ù„ Ø®Ø§ØµØ© Ø¨ÙƒÙ„ Ù†ÙˆØ¹ Ù…Ø¹ Ø§Ù„Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© -->
                        <p class="text-info" invisible="lookup_action != 'branch-all'">
                            <strong>ğŸ¢ Branch Mode:</strong> Will also extract city, region, and district information.
                        </p>
                        <p class="text-success" invisible="lookup_action != 'country'">
                            <strong>ğŸŒ Country Mode:</strong> Unified auto-linking with Odoo countries using <code>naql_id</code> field.
                        </p>
                        <p class="text-primary" invisible="lookup_action != 'yakeen-nationality'">
                            <strong>ğŸ†” Nationality Mode:</strong> Unified auto-linking with Odoo countries using <code>nationality_naql_id</code> field.
                        </p>
                    </div>
                </sheet>
            </form>
        </field>
    </record>

    <!-- Window Action -->
    <record id="action_api_wizard" model="ir.actions.act_window">
        <field name="name">API Lookup Tool</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">api.lookup.wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
        <field name="context">{
            'default_state': 'draft'
        }</field>
    </record>

    <!-- Menu Item -->
    <menuitem id="api_menu"
              name="API Lookup"
              parent="sta_integration.menu_sta_integration_root"
              action="action_api_wizard"
              sequence="50"/>
</odoo>